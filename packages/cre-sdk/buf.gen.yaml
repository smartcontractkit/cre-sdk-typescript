# Improved buf.gen.yaml using modern Protobuf-ES
version: v2

# Managed mode for better field handling
managed:
  enabled: true
  override:
    - field_option: jstype
      value: JS_NORMAL

inputs:
  - directory: ../../submodules/chainlink-protos/cre

plugins:
  # Modern @bufbuild/protoc-gen-es plugin
  - local: protoc-gen-es
    out: src/generated
    opt:
      # Generate TypeScript (required for WASM compilation)
      - target=ts

      # No import extension (modern bundlers handle this)
      - import_extension=none

      # Generate JSON types for better type safety
      - json_types=true

      # Keep empty files (useful for consistent imports)
      - keep_empty_files=false
